# Advent of Code (AoC) - day 6, task 2

import "prelude.eg"

using System, OS, List, String (from_chars, to_chars)

def main =
    read_lines stdin |> map to_chars |> [L ->
        (filter ((/=)' ') (last L) |> map ['+' -> (+)|'*' -> (*)],
        transpose (init L) |> map (do from_chars |> to_int) |> split_on 0)]
    |> uncurry zip |> map (uncurry reduce) |> sum
