# Advent of Code (AoC) - day 6, task 2

import "prelude.eg"

using System, OS, List, String (from_chars, to_chars), R = Regex

def main =
    read_lines stdin |> map to_chars |> [L -> [(L0,L1) -> 
        (filter ((/=)' ') L1 |> map ['+' -> (+)|'*' -> (*)],
        transpose L0 |> map (do from_chars |> to_int) |> split_on 0)
        ] (init L, last L)]
    |> uncurry zip |> map (uncurry reduce) |> sum
